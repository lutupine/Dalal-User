<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <link rel="stylesheet" href="css/swiper.min.css">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="cordova.js"></script>
        <script src="js/locationservices.js"></script>
        <link rel="stylesheet" href="css/mystyles.css">
        <title>OfferApp</title>
    </head>
        
    <body>
        
        <div class="row">
            <h1>App Name</h1>
        </div>        
        
        <div class="row" id="pagearea">
            
        </div>  

        <button class="bottom_static" id="hot">
            hot
        </button>
        
        <button class="bottom_static" id="featured">
            featured
        </button>
                
        <button class="bottom_static" id="category">
            category
        </button>
        
        <button class="bottom_static" id="notification">
            notification
        </button>
                
        <button class="bottom_static" id="location">
            location
        </button>
        
        <button class="bottom_static" id="fb">
            fb login
        </button>

        <form action="#">
            X : 
            <input id="xcor" type="text" value="0"><br>
            Y : 
            <input id="ycor" type="text" value="0"><br>
        </form>

        <button class="bottom_static" id="setnotification">
            set location notification
        </button>

        <form action="#">
            time in seconds : 
            <input id="timevalue" type="text" value="10"><br>
        </form>

        <button class="bottom_static" id="settime">
            set timed notification
        </button>

    </body>
    
    <script>

        var fbLoginSuccess = function (userData) {
            //alert(JSON.stringify (userData));
            alert (userData.status);
        }

        $("#fb").click(function(){
            facebookConnectPlugin.login(["public_profile"], fbLoginSuccess,
                function loginError (error) {
                    alert(error)
                }
            );
        }); 
                
        $("#hot").click(function(){
            $.ajax({
                url: "http://mango-bd.com/API/",
                data: '{"Limit":"2"}',
                dataType: 'json',
                headers: { 'Api': 'hot_deals', 'Method': 'list' },
                processData: false,
                type: "POST",
                success: function(data) {
                    alert(data);
                    var deal_data = data.result;
                    for (var i = 0; i < 2; i++) {
                        var deal_title = deal_data[i].title;
                        var deal_description = deal_data[i].description;
                        var deal_image_url = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLRhPxq16yKv90eHGMRMLs3OR34tI0SaVyxZQ-sxNGeWLILYLb";
                        var segment = '<div class="col-md-6 container-fluid deal_container"><div class="col-xs-3"><img id="deal_image" src="'+deal_image_url+'"></div><div class="col-xs-9"><h1 id="deal_title">'+deal_title+'</h1><p id="deal_description">'+deal_description+'</p></div></div>';
                        $("#pagearea").append(segment);
                    }
                },
                error: function(err){
                    alert(err.status);
                }
            });
        });  

        $("#featured").click(function(){
            $.ajax({
                url: "http://mango-bd.com/API/",
                data: '{"Limit":"2"}',
                dataType: 'json',
                headers: { 'Api': 'featured_deals', 'Method': 'list' },
                processData: false,
                type: "POST",
                success: function(data) {
                    alert(data);
                    var deal_data = data.result;
                    for (var i = 0; i < 2; i++) {
                        var deal_title = deal_data[i].title;
                        var deal_description = deal_data[i].description;
                        var deal_image_url = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLRhPxq16yKv90eHGMRMLs3OR34tI0SaVyxZQ-sxNGeWLILYLb";
                        var segment = '<div class="col-md-6 container-fluid deal_container"><div class="col-xs-3"><img id="deal_image" src="'+deal_image_url+'"></div><div class="col-xs-9"><h1 id="deal_title">'+deal_title+'</h1><p id="deal_description">'+deal_description+'</p></div></div>';
                        $("#pagearea").append(segment);
                    }
                },
                error: function(err){
                    alert(err.status);
                }
            });
        });
                
        $("#category").click(function(){
            $.ajax({
                url: "http://mango-bd.com/API/",
                data: '{"Limit":"2"}',
                dataType: 'json',
                headers: { 'Api': 'categories', 'Method': 'list' },
                processData: false,
                type: "POST",
                success: function(data) {
                    alert(data);
                    var deal_data = data.result;
                    for (var i = 0; i < 2; i++) {
                        var deal_title = deal_data[i].title;
                        var deal_description = deal_data[i].description;
                        var deal_image_url = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLRhPxq16yKv90eHGMRMLs3OR34tI0SaVyxZQ-sxNGeWLILYLb";
                        var segment = '<div class="col-md-6 container-fluid deal_container"><div class="col-xs-3"><img id="deal_image" src="'+deal_image_url+'"></div><div class="col-xs-9"><h1 id="deal_title">'+deal_title+'</h1><p id="deal_description">'+deal_description+'</p></div></div>';
                        $("#pagearea").append(segment);
                    }
                },
                error: function(err){
                    alert(err.status);
                }
            });
        });
                
        $("#notification").click(function(){
            cordova.plugins.notification.local.requestPermission(function (granted) {
                cordova.plugins.notification.local.schedule({
                    title: 'Test Success',
                    text: 'Thats pretty easy...',
                    foreground: true
                });                
            }); 
        });

       $("#setnotification").click(function (){
            var x = $("#xcor").val();
            var y = $("#ycor").val();
            alert('x: '+x+' y: '+y);            
            cordova.plugins.notification.local.schedule({
                title: 'Welcome to' + x + ' ' + y,
                trigger: {
                    type: 'location',
                    center: [x , y],
                    radius: 25,
                    notifyOnEntry: true,
                }
            });
        });

        $("#settime").click(function (){
            var x = $("#timevalue").val();
            alert('trigger in : '+x);            
            cordova.plugins.notification.local.schedule({
                title: 'Triggered at time',
                trigger: { in: x, unit: 'second' }
            });
        });
                
        $("#location").click(function(){
            GetCurrentLocation();
        });
        
        
    </script>
    
</html>